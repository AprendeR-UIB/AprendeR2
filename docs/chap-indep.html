<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lección 7 Contrastes de independencia y homogeneidad | AprendeR: Parte II</title>
  <meta name="description" content="Apuntes AprendeR bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Lección 7 Contrastes de independencia y homogeneidad | AprendeR: Parte II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes AprendeR bookdown::gitbook." />
  <meta name="github-repo" content="AprendeR-UIB/AprendeR2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lección 7 Contrastes de independencia y homogeneidad | AprendeR: Parte II" />
  
  <meta name="twitter:description" content="Apuntes AprendeR bookdown::gitbook." />
  

<meta name="author" content="The UIB-AprendeR team">


<meta name="date" content="2020-02-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chap-bondad.html">
<link rel="next" href="chap-estmult.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">AprendeR: Parte II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentación</a></li>
<li class="part"><span><b>Parte II: Estadística inferencial</b></span></li>
<li class="chapter" data-level="1" data-path="chap-distr.html"><a href="chap-distr.html"><i class="fa fa-check"></i><b>1</b> Distribuciones de probabilidad</a><ul>
<li class="chapter" data-level="1.1" data-path="chap-distr.html"><a href="chap-distr.html#ejercicios"><i class="fa fa-check"></i><b>1.1</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-distr.html"><a href="chap-distr.html#test"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-distr.html"><a href="chap-distr.html#problemas"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-distr.html"><a href="chap-distr.html#respuestas-al-test"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-distr.html"><a href="chap-distr.html#soluciones-sucintas-de-los-problemas"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap-muestreo.html"><a href="chap-muestreo.html"><i class="fa fa-check"></i><b>2</b> Conceptos básicos de muestreo</a><ul>
<li class="chapter" data-level="2.1" data-path="chap-muestreo.html"><a href="chap-muestreo.html#sec:muestreo"><i class="fa fa-check"></i><b>2.1</b> Tipos de muestreo</a></li>
<li class="chapter" data-level="2.2" data-path="chap-muestreo.html"><a href="chap-muestreo.html#muestreo-aleatorio-con-r"><i class="fa fa-check"></i><b>2.2</b> Muestreo aleatorio con R</a></li>
<li class="chapter" data-level="2.3" data-path="chap-muestreo.html"><a href="chap-muestreo.html#guia-rapida"><i class="fa fa-check"></i><b>2.3</b> Guía rápida</a></li>
<li class="chapter" data-level="2.4" data-path="chap-muestreo.html"><a href="chap-muestreo.html#ejercicios-1"><i class="fa fa-check"></i><b>2.4</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-muestreo.html"><a href="chap-muestreo.html#test-1"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-muestreo.html"><a href="chap-muestreo.html#problemas-1"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-muestreo.html"><a href="chap-muestreo.html#respuestas-al-test-1"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-muestreo.html"><a href="chap-muestreo.html#soluciones-sucintas-de-los-problemas-1"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap-estimacion.html"><a href="chap-estimacion.html"><i class="fa fa-check"></i><b>3</b> Estimación puntual</a><ul>
<li class="chapter" data-level="3.1" data-path="chap-estimacion.html"><a href="chap-estimacion.html#estimacion-maximo-verosimil"><i class="fa fa-check"></i><b>3.1</b> Estimación máximo verosímil</a></li>
<li class="chapter" data-level="3.2" data-path="chap-estimacion.html"><a href="chap-estimacion.html#guia-rapida-1"><i class="fa fa-check"></i><b>3.2</b> Guía rápida</a></li>
<li class="chapter" data-level="3.3" data-path="chap-estimacion.html"><a href="chap-estimacion.html#ejercicios-2"><i class="fa fa-check"></i><b>3.3</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-estimacion.html"><a href="chap-estimacion.html#test-2"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-estimacion.html"><a href="chap-estimacion.html#problemas-2"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-estimacion.html"><a href="chap-estimacion.html#respuestas-al-test-2"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-estimacion.html"><a href="chap-estimacion.html#soluciones-sucintas-de-los-problemas-2"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap-IC.html"><a href="chap-IC.html"><i class="fa fa-check"></i><b>4</b> Intervalos de confianza</a><ul>
<li class="chapter" data-level="4.1" data-path="chap-IC.html"><a href="chap-IC.html#sec:ICT"><i class="fa fa-check"></i><b>4.1</b> Intervalo de confianza para la media basado en la t de Student</a></li>
<li class="chapter" data-level="4.2" data-path="chap-IC.html"><a href="chap-IC.html#intervalos-de-confianza-para-la-proporcion-poblacional"><i class="fa fa-check"></i><b>4.2</b> Intervalos de confianza para la proporción poblacional</a></li>
<li class="chapter" data-level="4.3" data-path="chap-IC.html"><a href="chap-IC.html#sec:ICvar"><i class="fa fa-check"></i><b>4.3</b> Intervalo de confianza para la varianza de una población normal</a></li>
<li class="chapter" data-level="4.4" data-path="chap-IC.html"><a href="chap-IC.html#bootstrap"><i class="fa fa-check"></i><b>4.4</b> Bootstrap</a></li>
<li class="chapter" data-level="4.5" data-path="chap-IC.html"><a href="chap-IC.html#guia-rapida-2"><i class="fa fa-check"></i><b>4.5</b> Guía rápida</a></li>
<li class="chapter" data-level="4.6" data-path="chap-IC.html"><a href="chap-IC.html#ejercicios-3"><i class="fa fa-check"></i><b>4.6</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#test-3"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#problemas-3"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#respuestas-al-test-3"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-IC.html"><a href="chap-IC.html#soluciones-sucintas-de-los-problemas-3"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-contrastes.html"><a href="chap-contrastes.html"><i class="fa fa-check"></i><b>5</b> Contrastes de hipótesis</a><ul>
<li class="chapter" data-level="5.1" data-path="chap-contrastes.html"><a href="chap-contrastes.html#contrastes-para-medias"><i class="fa fa-check"></i><b>5.1</b> Contrastes para medias</a><ul>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#el-test-t"><i class="fa fa-check"></i>El test t</a></li>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#tests-no-parametricos"><i class="fa fa-check"></i>Tests no paramétricos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chap-contrastes.html"><a href="chap-contrastes.html#contrastes-para-varianzas"><i class="fa fa-check"></i><b>5.2</b> Contrastes para varianzas</a></li>
<li class="chapter" data-level="5.3" data-path="chap-contrastes.html"><a href="chap-contrastes.html#contrastes-para-proporciones"><i class="fa fa-check"></i><b>5.3</b> Contrastes para proporciones</a></li>
<li class="chapter" data-level="5.4" data-path="chap-contrastes.html"><a href="chap-contrastes.html#calculo-de-la-potencia-de-un-contraste"><i class="fa fa-check"></i><b>5.4</b> Cálculo de la potencia de un contraste</a></li>
<li class="chapter" data-level="5.5" data-path="chap-contrastes.html"><a href="chap-contrastes.html#guia-rapida-3"><i class="fa fa-check"></i><b>5.5</b> Guía rápida</a></li>
<li class="chapter" data-level="5.6" data-path="chap-contrastes.html"><a href="chap-contrastes.html#ejercicios-4"><i class="fa fa-check"></i><b>5.6</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#modelo-de-test"><i class="fa fa-check"></i>Modelo de test</a></li>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#ejercicios-5"><i class="fa fa-check"></i>Ejercicios</a></li>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#respuestas-al-test-4"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-contrastes.html"><a href="chap-contrastes.html#respuestas-sucintas-a-los-ejercicios"><i class="fa fa-check"></i>Respuestas sucintas a los ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-bondad.html"><a href="chap-bondad.html"><i class="fa fa-check"></i><b>6</b> Contrastes de bondad de ajuste</a><ul>
<li class="chapter" data-level="6.1" data-path="chap-bondad.html"><a href="chap-bondad.html#pruebas-graficas-q-q-plots"><i class="fa fa-check"></i><b>6.1</b> Pruebas gráficas: Q-Q-plots</a></li>
<li class="chapter" data-level="6.2" data-path="chap-bondad.html"><a href="chap-bondad.html#el-test-chi2-de-pearson"><i class="fa fa-check"></i><b>6.2</b> El test <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="6.3" data-path="chap-bondad.html"><a href="chap-bondad.html#el-test-chi2-para-distribuciones-continuas"><i class="fa fa-check"></i><b>6.3</b> El test <span class="math inline">\(\chi^2\)</span> para distribuciones continuas</a></li>
<li class="chapter" data-level="6.4" data-path="chap-bondad.html"><a href="chap-bondad.html#el-test-de-kolgomorov-smirnov"><i class="fa fa-check"></i><b>6.4</b> El test de Kolgomorov-Smirnov</a></li>
<li class="chapter" data-level="6.5" data-path="chap-bondad.html"><a href="chap-bondad.html#tests-de-normalidad"><i class="fa fa-check"></i><b>6.5</b> Tests de normalidad</a></li>
<li class="chapter" data-level="6.6" data-path="chap-bondad.html"><a href="chap-bondad.html#guia-rapida-4"><i class="fa fa-check"></i><b>6.6</b> Guía rápida</a></li>
<li class="chapter" data-level="6.7" data-path="chap-bondad.html"><a href="chap-bondad.html#ejercicios-6"><i class="fa fa-check"></i><b>6.7</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-bondad.html"><a href="chap-bondad.html#modelo-de-test-1"><i class="fa fa-check"></i>Modelo de test</a></li>
<li class="chapter" data-level="" data-path="chap-bondad.html"><a href="chap-bondad.html#problemas-4"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-bondad.html"><a href="chap-bondad.html#respuestas-al-test-5"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-bondad.html"><a href="chap-bondad.html#soluciones-sucintas-de-los-problemas-4"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap-indep.html"><a href="chap-indep.html"><i class="fa fa-check"></i><b>7</b> Contrastes de independencia y homogeneidad</a><ul>
<li class="chapter" data-level="7.1" data-path="chap-indep.html"><a href="chap-indep.html#tablas-de-contingencia"><i class="fa fa-check"></i><b>7.1</b> Tablas de contingencia</a></li>
<li class="chapter" data-level="7.2" data-path="chap-indep.html"><a href="chap-indep.html#contraste-de-independencia"><i class="fa fa-check"></i><b>7.2</b> Contraste de independencia</a></li>
<li class="chapter" data-level="7.3" data-path="chap-indep.html"><a href="chap-indep.html#sec:hom"><i class="fa fa-check"></i><b>7.3</b> Contraste de homogeneidad</a></li>
<li class="chapter" data-level="7.4" data-path="chap-indep.html"><a href="chap-indep.html#potencia-de-un-contraste-chi2"><i class="fa fa-check"></i><b>7.4</b> Potencia de un contraste <span class="math inline">\(\chi^2\)</span></a></li>
<li class="chapter" data-level="7.5" data-path="chap-indep.html"><a href="chap-indep.html#guia-rapida-5"><i class="fa fa-check"></i><b>7.5</b> Guía rápida</a></li>
<li class="chapter" data-level="7.6" data-path="chap-indep.html"><a href="chap-indep.html#ejercicios-7"><i class="fa fa-check"></i><b>7.6</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-indep.html"><a href="chap-indep.html#modelo-de-test-2"><i class="fa fa-check"></i>Modelo de test</a></li>
<li class="chapter" data-level="" data-path="chap-indep.html"><a href="chap-indep.html#ejercicios-8"><i class="fa fa-check"></i>Ejercicios</a></li>
<li class="chapter" data-level="" data-path="chap-indep.html"><a href="chap-indep.html#respuestas-al-test-6"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-indep.html"><a href="chap-indep.html#soluciones-sucintas-de-los-problemas-5"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap-estmult.html"><a href="chap-estmult.html"><i class="fa fa-check"></i><b>8</b> Introducción a la estadística descriptiva multidimensional</a><ul>
<li class="chapter" data-level="8.1" data-path="chap-estmult.html"><a href="chap-estmult.html#matrices-de-datos-cuantitativos"><i class="fa fa-check"></i><b>8.1</b> Matrices de datos cuantitativos</a></li>
<li class="chapter" data-level="8.2" data-path="chap-estmult.html"><a href="chap-estmult.html#transformaciones-lineales"><i class="fa fa-check"></i><b>8.2</b> Transformaciones lineales</a></li>
<li class="chapter" data-level="8.3" data-path="chap-estmult.html"><a href="chap-estmult.html#covarianzas-y-correlaciones"><i class="fa fa-check"></i><b>8.3</b> Covarianzas y correlaciones</a></li>
<li class="chapter" data-level="8.4" data-path="chap-estmult.html"><a href="chap-estmult.html#correlacion-de-spearman"><i class="fa fa-check"></i><b>8.4</b> Correlación de Spearman</a></li>
<li class="chapter" data-level="8.5" data-path="chap-estmult.html"><a href="chap-estmult.html#contrastes-de-correlacion"><i class="fa fa-check"></i><b>8.5</b> Contrastes de correlación</a></li>
<li class="chapter" data-level="8.6" data-path="chap-estmult.html"><a href="chap-estmult.html#un-ejemplo"><i class="fa fa-check"></i><b>8.6</b> Un ejemplo</a></li>
<li class="chapter" data-level="8.7" data-path="chap-estmult.html"><a href="chap-estmult.html#representacion-grafica-de-datos-multidimensionales"><i class="fa fa-check"></i><b>8.7</b> Representación gráfica de datos multidimensionales</a></li>
<li class="chapter" data-level="8.8" data-path="chap-estmult.html"><a href="chap-estmult.html#guia-rapida-6"><i class="fa fa-check"></i><b>8.8</b> Guía rápida</a></li>
<li class="chapter" data-level="8.9" data-path="chap-estmult.html"><a href="chap-estmult.html#ejercicios-9"><i class="fa fa-check"></i><b>8.9</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-estmult.html"><a href="chap-estmult.html#modelo-de-test-3"><i class="fa fa-check"></i>Modelo de test</a></li>
<li class="chapter" data-level="" data-path="chap-estmult.html"><a href="chap-estmult.html#problemas-5"><i class="fa fa-check"></i>Problemas</a></li>
<li class="chapter" data-level="" data-path="chap-estmult.html"><a href="chap-estmult.html#respuestas-al-test-7"><i class="fa fa-check"></i>Respuestas al test</a></li>
<li class="chapter" data-level="" data-path="chap-estmult.html"><a href="chap-estmult.html#soluciones-sucintas-de-los-problemas-6"><i class="fa fa-check"></i>Soluciones sucintas de los problemas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html"><i class="fa fa-check"></i><b>9</b> ANOVA básico</a><ul>
<li class="chapter" data-level="9.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#sec:modelos"><i class="fa fa-check"></i><b>9.1</b> Los modelos del ANOVA en R</a></li>
<li class="chapter" data-level="9.2" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#sec:ANOVA-1"><i class="fa fa-check"></i><b>9.2</b> ANOVA de un factor</a></li>
<li class="chapter" data-level="9.3" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#anova-de-bloques-completos-aleatorios"><i class="fa fa-check"></i><b>9.3</b> ANOVA de bloques completos aleatorios</a></li>
<li class="chapter" data-level="9.4" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#sec:ANOVA2"><i class="fa fa-check"></i><b>9.4</b> ANOVA de dos vías</a></li>
<li class="chapter" data-level="9.5" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#condiciones-del-anova"><i class="fa fa-check"></i><b>9.5</b> Condiciones del ANOVA</a></li>
<li class="chapter" data-level="9.6" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#sec:pares"><i class="fa fa-check"></i><b>9.6</b> Comparaciones de pares de medias</a><ul>
<li class="chapter" data-level="9.6.1" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#tests-t-por-parejas"><i class="fa fa-check"></i><b>9.6.1</b> Tests t por parejas</a></li>
<li class="chapter" data-level="9.6.2" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#test-de-duncan"><i class="fa fa-check"></i><b>9.6.2</b> Test de Duncan</a></li>
<li class="chapter" data-level="9.6.3" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#metodo-de-tukey"><i class="fa fa-check"></i><b>9.6.3</b> Método de Tukey</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#metodos-no-parametricos"><i class="fa fa-check"></i><b>9.7</b> Métodos no paramétricos</a></li>
<li class="chapter" data-level="9.8" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#guia-rapida-7"><i class="fa fa-check"></i><b>9.8</b> Guía rápida</a></li>
<li class="chapter" data-level="9.9" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#ejercicios-10"><i class="fa fa-check"></i><b>9.9</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#test-4"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-ANOVA.html"><a href="chap-ANOVA.html#respuestas-al-test-8"><i class="fa fa-check"></i>Respuestas al test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap-regresion.html"><a href="chap-regresion.html"><i class="fa fa-check"></i><b>10</b> Regresión lineal</a><ul>
<li class="chapter" data-level="10.1" data-path="chap-regresion.html"><a href="chap-regresion.html#sec:1"><i class="fa fa-check"></i><b>10.1</b> El modelo de regresión lineal en R</a></li>
<li class="chapter" data-level="10.2" data-path="chap-regresion.html"><a href="chap-regresion.html#intervalos-de-confianza-en-el-modelo-de-regresion-lineal"><i class="fa fa-check"></i><b>10.2</b> Intervalos de confianza en el modelo de regresión lineal</a></li>
<li class="chapter" data-level="10.3" data-path="chap-regresion.html"><a href="chap-regresion.html#sec:seleccion"><i class="fa fa-check"></i><b>10.3</b> Selección del modelo en base al ajuste de los datos</a></li>
<li class="chapter" data-level="10.4" data-path="chap-regresion.html"><a href="chap-regresion.html#sec:diagn"><i class="fa fa-check"></i><b>10.4</b> Diagnósticos de regresión</a></li>
<li class="chapter" data-level="10.5" data-path="chap-regresion.html"><a href="chap-regresion.html#guia-rapida-8"><i class="fa fa-check"></i><b>10.5</b> Guía rápida</a></li>
<li class="chapter" data-level="10.6" data-path="chap-regresion.html"><a href="chap-regresion.html#ejercicios-11"><i class="fa fa-check"></i><b>10.6</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-regresion.html"><a href="chap-regresion.html#test-5"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-regresion.html"><a href="chap-regresion.html#respuestas-al-test-9"><i class="fa fa-check"></i>Respuestas al test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap-clustering.html"><a href="chap-clustering.html"><i class="fa fa-check"></i><b>11</b> <em>Clustering</em> básico</a><ul>
<li class="chapter" data-level="11.1" data-path="chap-clustering.html"><a href="chap-clustering.html#metodo-de-k-medias-o-k-means"><i class="fa fa-check"></i><b>11.1</b> Método de k-medias o <em>k-means</em></a></li>
<li class="chapter" data-level="11.2" data-path="chap-clustering.html"><a href="chap-clustering.html#eleccion-del-numero-de-clusters"><i class="fa fa-check"></i><b>11.2</b> Elección del número de <em>clusters</em></a></li>
<li class="chapter" data-level="11.3" data-path="chap-clustering.html"><a href="chap-clustering.html#metodos-jerarquicos-aglomerativos"><i class="fa fa-check"></i><b>11.3</b> Métodos jerárquicos aglomerativos</a></li>
<li class="chapter" data-level="11.4" data-path="chap-clustering.html"><a href="chap-clustering.html#guia-rapida-9"><i class="fa fa-check"></i><b>11.4</b> Guía rápida</a></li>
<li class="chapter" data-level="11.5" data-path="chap-clustering.html"><a href="chap-clustering.html#ejercicios-12"><i class="fa fa-check"></i><b>11.5</b> Ejercicios</a><ul>
<li class="chapter" data-level="" data-path="chap-clustering.html"><a href="chap-clustering.html#test-6"><i class="fa fa-check"></i>Test</a></li>
<li class="chapter" data-level="" data-path="chap-clustering.html"><a href="chap-clustering.html#respuestas-al-test-10"><i class="fa fa-check"></i>Respuestas al test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html"><i class="fa fa-check"></i><b>12</b> Extras de <em>R Markdown</em></a><ul>
<li class="chapter" data-level="12.1" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html#parametros-de-los-chunks-de-r"><i class="fa fa-check"></i><b>12.1</b> Parámetros de los <em>chunks</em> de R</a></li>
<li class="chapter" data-level="12.2" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html#los-chunks-en-modo-linea"><i class="fa fa-check"></i><b>12.2</b> Los <em>chunks</em> en modo línea</a></li>
<li class="chapter" data-level="12.3" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html#figuras"><i class="fa fa-check"></i><b>12.3</b> Figuras</a></li>
<li class="chapter" data-level="12.4" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html#tablas"><i class="fa fa-check"></i><b>12.4</b> Tablas</a></li>
<li class="chapter" data-level="12.5" data-path="extras-de-r-markdown.html"><a href="extras-de-r-markdown.html#formulas-matematicas"><i class="fa fa-check"></i><b>12.5</b> Fórmulas matemáticas</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/cescrossello/AprendeR-II" target="blank">Publicado con  bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AprendeR: Parte II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap:indep" class="section level1">
<h1><span class="header-section-number">Lección 7</span> Contrastes de independencia y homogeneidad</h1>
<p>El test <span class="math inline">\(\chi^2\)</span> explicado en la lección anterior permite contrastar, en situaciones adecuadas, si una muestra proviene de una determinada distribución y por lo tanto también si una muestra sigue la misma distribución que otra muestra. Como, en última instancia, la independencia de dos variables cualitativas se puede describir en términos de igualdades de probabilidades, el test <span class="math inline">\(\chi^2\)</span> también nos permitirá contrastar si dos variables cualitativas son independientes, tanto en el sentido de que las probabilidades conjuntas sean el producto de las probabilidades marginales (con un contraste de independencia) como en el sentido de que las distribuciones condicionadas de una respecto de los valores de la otra sean todas iguales (con un contraste de homogeneidad).</p>
<p>Aunque, como veremos, los contrastes de independencia y homogeneidad son idénticos desde el punto de vista matemático e incluso utilizan el mismo estadístico <span class="math inline">\(\chi^2\)</span> y la misma definición de p-valor, provienen de diseños experimentales diferentes:</p>
<ul>
<li><p>En un <strong>contraste de independencia</strong> se toma una <strong>muestra transversal</strong> de la población, es decir, se selecciona al azar una cierta cantidad de individuos de la
población, se observan las dos variables sobre cada uno de ellos, y se contrasta si las probabilidades conjuntas son iguales al producto de las probabilidades marginales de
cada variable. Formalmente, si <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son las dos variables, se contrasta si para cada par de posibles valores <span class="math inline">\(x\)</span> de <span class="math inline">\(X\)</span> e <span class="math inline">\(y\)</span> de <span class="math inline">\(Y\)</span> se tiene que
<span class="math display">\[
P(X=x,Y=y)=P(X=x)\cdot P(Y=y)
\]</span>
o si por el contrario hay algún par de valores <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> para los que esta igualdad sea falsa.</p></li>
<li><p>En un <strong>contraste de homogeneidad</strong> se escoge una de las variables y para cada uno de sus posibles valores se toma una muestra aleatoria, de tamaño prefijado, de individuos con ese valor para esa variable; su unión forma una <strong>muestra estratificada</strong> en el sentido de la Sección <a href="chap-muestreo.html#sec:muestreo">2.1</a>. A continuación, se observa sobre cada uno de estos individuos la otra variable. En esta situación contrastamos si la distribución de probabilidades de la segunda variable es la misma en los diferentes estratos definidos por los niveles de la primera variable. Formalmente, si <span class="math inline">\(Y\)</span> es la variable que usamos en primer lugar para clasificar los individuos de la población y tomar una muestra de cada clase, con posibles valores <span class="math inline">\(y_1,\ldots,y_k\)</span>, y <span class="math inline">\(X\)</span> es la variable que medimos en segundo lugar sobre los individuos escogidos, se contrasta si, para cada posible valor <span class="math inline">\(x\)</span> de <span class="math inline">\(X\)</span>,
<span class="math display">\[
P(X=x|Y=y_1)=P(X=x|Y=y_2)=\cdots=P(X=x|Y=y_k)
\]</span>
o si por el contrario existen <span class="math inline">\(x\)</span>, <span class="math inline">\(y_i\)</span>, <span class="math inline">\(y_j\)</span> tales que <span class="math inline">\(P(X=x|Y=y_i)\neq P(X=x|Y=y_j)\)</span>.</p></li>
</ul>
<p>En ambos contrastes, la hipótesis nula es que las variables son independientes, bajo una u otra formulación matemática, y la hipótesis alternativa es que son <strong>dependientes</strong> (o que <strong>hay asociación</strong> entre ellas). La hipótesis nula se rechaza si se obtiene evidencia que hace inverosímiles las igualdades de probabilidades que se contrastan.</p>
<p>Para ilustrar esta lección, hemos generado una muestra aleatoria de cadenas formadas por las
bases “a”, “c”, “g” y “t”. En concreto, hemos generado cadenas de longitud 100 de tres tipos: <em>A</em>, <em>B</em> y <em>C.</em> Estos tipos se distinguen por los vectores de probabilidades que han determinado las frecuencias de las cuatro bases en las secuencias. Queremos investigar si hay relación entre el tipo (A, B o C) de una cadena, y la base de frecuencia máxima en ella.</p>
<p>Los datos y el método de generación se encuentran en el repositorio siguiente:
<a href="https://github.com/biocom-uib/Experimento-Cadenas" class="uri">https://github.com/biocom-uib/Experimento-Cadenas</a>. Este directorio contiene:</p>
<ul>
<li><p>El fichero <a href="https://biocom-uib.github.io/Experimento-Cadenas/"><em>LeemeGeneracionDatos</em></a>, que explica cómo se han generado las muestras.</p></li>
<li><p>El fichero <a href="https://raw.githubusercontent.com/biocom-uib/Experimento-Cadenas/master/MuestraTotalBases.txt"><em>MuestraTotalBases.txt</em></a>, que contiene una tabla de datos de 10000 observaciones de las dos variables siguientes sobre cadenas: el <code>tipo</code>, que es un factor con los niveles <code>A</code>, <code>B</code> y <code>C</code>, y <code>max.frec</code>, que es otro factor que indica qué base tiene mayor frecuencia en la cadena. Este fichero es de formato texto, con una primera fila con el nombre de las variables y sus columnas separadas por comas</p></li>
</ul>
<p>El código siguiente carga la tabla de datos, comprueba que no ha habido problemas, y extrae tres subtablas, una para cada tipo de cadena.</p>
<pre class="sourceCode r"><code class="sourceCode r">poblacion=<span class="kw">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/biocom-uib/Experimento-Cadenas/master/MuestraTotalBases.txt&quot;</span>,
                      <span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)
<span class="kw">str</span>(poblacion)</code></pre>
<pre><code>## &#39;data.frame&#39;:    10000 obs. of  2 variables:
##  $ tipo    : Factor w/ 3 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;: 2 1 1 3 1 1 1 3 2 2 ...
##  $ max.frec: Factor w/ 4 levels &quot;a&quot;,&quot;c&quot;,&quot;g&quot;,&quot;t&quot;: 3 1 2 4 4 1 1 3 2 2 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(poblacion)</code></pre>
<pre><code>##   tipo max.frec
## 1    B        g
## 2    A        a
## 3    A        c
## 4    C        t
## 5    A        t
## 6    A        a</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">poblacionA=<span class="kw">subset</span>(poblacion,tipo<span class="op">==</span><span class="st">&quot;A&quot;</span>)
poblacionB=<span class="kw">subset</span>(poblacion,tipo<span class="op">==</span><span class="st">&quot;B&quot;</span>)
poblacionC=<span class="kw">subset</span>(poblacion,tipo<span class="op">==</span><span class="st">&quot;C&quot;</span>)</code></pre>
<div id="tablas-de-contingencia" class="section level2">
<h2><span class="header-section-number">7.1</span> Tablas de contingencia</h2>
<p>Ya estudiamos en la Lección <a href="#chap:edqual"><strong>??</strong></a> de la primera parte las tablas de contingencia.
En esta sección vamos a repasar y ampliar algunas de las funciones de R para el manejo de
esta clase de tablas.</p>
<p>La tabla de contingencia de frecuencias absolutas conjuntas de las dos variables del <em>data frame</em> <code>poblacion</code> se calcula de la manera siguiente:</p>
<pre class="sourceCode r"><code class="sourceCode r">tabla=<span class="kw">table</span>(poblacion<span class="op">$</span>tipo,poblacion<span class="op">$</span>max.frec)
tabla</code></pre>
<pre><code>##    
##        a    c    g    t
##   A 1027 1003  998  998
##   B 1259 1297  209  232
##   C  245  602 1453  677</code></pre>
<p>Su tabla de frecuencias relativas conjuntas en el total de la muestra, en términos de proporciones (tantos por uno), es:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(tabla)</code></pre>
<pre><code>##    
##          a      c      g      t
##   A 0.1027 0.1003 0.0998 0.0998
##   B 0.1259 0.1297 0.0209 0.0232
##   C 0.0245 0.0602 0.1453 0.0677</code></pre>
<p>Para añadir las <strong>distribuciones marginales</strong> de la tabla de contingencia (o <strong>márgenes</strong> de
la tabla), se añade una nueva fila con las sumas de cada columna y una nueva columna con las sumas de cada fila. Con R, esto se puede llevar a cabo fácilmente con la función
<code>addmargins</code>. Su sintaxis básica es</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla, <span class="dt">margin=</span>..., <span class="dt">FUN=</span>...)</code></pre>
<p>donde:</p>
<ul>
<li><p><code>tabla</code> es una <code>table</code>.</p></li>
<li><p><code>margin</code> es un parámetro que puede tomar los valores siguientes:</p>
<ul>
<li><code>1</code> si queremos una nueva fila con las marginales de cada columna.</li>
<li><code>2</code> si queremos una nueva columna con las marginales de cada fila.</li>
<li><code>c(1,2)</code>, que es el valor por defecto para tablas de contingencia bidimensionales (y por lo tanto no hace falta especificarlo), si queremos las marginales por filas y por columnas.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></li>
</ul></li>
<li><p><code>FUN</code> es la función que se aplica a las filas o columnas para obtener el valor marginal. Por defecto es la suma, que es la función que nos interesa en esta lección, y por tanto tampoco hace falta especificarlo.</p></li>
</ul>
<p>El resultado es otro objeto de la clase <code>table</code> al que se le han añadido una
o varias filas o columnas. Éstas contienen los márgenes resultantes
de aplicar la función indicada por <code>FUN</code>. La etiqueta de las nuevas filas o columnas es la
función que se aplica.</p>
<p>Por ejemplo, para obtener las tablas marginales completas de frecuencias absolutas y relativas en nuestro ejemplo, haríamos:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla) </code></pre>
<pre><code>##      
##           a     c     g     t   Sum
##   A    1027  1003   998   998  4026
##   B    1259  1297   209   232  2997
##   C     245   602  1453   677  2977
##   Sum  2531  2902  2660  1907 10000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(<span class="kw">prop.table</span>(tabla)) </code></pre>
<pre><code>##      
##            a      c      g      t    Sum
##   A   0.1027 0.1003 0.0998 0.0998 0.4026
##   B   0.1259 0.1297 0.0209 0.0232 0.2997
##   C   0.0245 0.0602 0.1453 0.0677 0.2977
##   Sum 0.2531 0.2902 0.2660 0.1907 1.0000</code></pre>
<p>También podemos calcular la tabla de proporciones por filas y con su marginal por filas comprobar que efectivamente la suma de cada fila es 1:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(<span class="kw">prop.table</span>(tabla,<span class="dt">margin=</span><span class="dv">1</span>),<span class="dt">margin=</span><span class="dv">2</span>)</code></pre>
<pre><code>##    
##             a         c         g         t       Sum
##   A 0.2550919 0.2491307 0.2478887 0.2478887 1.0000000
##   B 0.4200868 0.4327661 0.0697364 0.0774107 1.0000000
##   C 0.0822976 0.2022170 0.4880752 0.2274101 1.0000000</code></pre>
<p>Y viceversa, podemos calcular la tabla de proporciones por columnas y con su marginal por columnas comprobar que efectivamente la suma de cada columna es 1:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(<span class="kw">prop.table</span>(tabla,<span class="dt">margin=</span><span class="dv">2</span>),<span class="dt">margin=</span><span class="dv">1</span>)</code></pre>
<pre><code>##      
##               a         c         g         t
##   A   0.4057685 0.3456237 0.3751880 0.5233351
##   B   0.4974318 0.4469331 0.0785714 0.1216571
##   C   0.0967997 0.2074431 0.5462406 0.3550079
##   Sum 1.0000000 1.0000000 1.0000000 1.0000000</code></pre>
<p>Observad que el significado de <code>margin</code> en <code>addmargins</code> es diferente de, por ejemplo, en <code>prop.table</code> o en <code>apply</code>: en estas dos últimas instrucciones indica la dimensión en la que calculamos las proporciones o aplicamos la función, mientras que en <code>addmargins</code> indica la dimensión en la que <em>añadimos</em> el margen, que, por lo tanto, se calcula aplicando la función en la otra dimensión.</p>
<p>Si sólo nos interesa la fila o la columna de marginales, podemos usar las instrucciones
<code>colSums</code> y <code>rowSums</code>, que suman una tabla por columnas y por filas, respectivamente. Por ejemplo, para obtener los vectores de marginales por columnas y por filas, respectivamente, podríamos entrar:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(tabla)</code></pre>
<pre><code>##    a    c    g    t 
## 2531 2902 2660 1907</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowSums</span>(tabla)</code></pre>
<pre><code>##    A    B    C 
## 4026 2997 2977</code></pre>
<p>También podemos obtener estos márgenes extrayendo los márgenes de la tabla con márgenes, obtenida aplicando <code>addmargins</code> a la tabla original, por medio de las instrucciones usuales para extraer filas y columnas.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla)[<span class="st">&quot;Sum&quot;</span>,<span class="op">-</span><span class="kw">dim</span>(<span class="kw">addmargins</span>(tabla))[<span class="dv">2</span>]]</code></pre>
<pre><code>##    a    c    g    t 
## 2531 2902 2660 1907</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla)[<span class="op">-</span><span class="kw">dim</span>(<span class="kw">addmargins</span>(tabla))[<span class="dv">1</span>],<span class="st">&quot;Sum&quot;</span>]</code></pre>
<pre><code>##    A    B    C 
## 4026 2997 2977</code></pre>
<p>Observad, por ejemplo, la construcción</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla)[<span class="st">&quot;Sum&quot;</span>,<span class="op">-</span><span class="kw">dim</span>(<span class="kw">addmargins</span>(tabla))[<span class="dv">2</span>]]</code></pre>
<p>Con <code>addmargins(tabla)[&quot;Sum&quot;,]</code> obtendríamos la fila <code>Sum</code> de la tabla con las marginales, incluyendo la última entrada, correspondiente a la columna <code>Sum</code>. Por lo tanto, hay que eliminarla: como <code>dim(addmargins(tabla))[2]</code> es el número de columnas de la tabla <code>addmargins(tabla)</code>, es decir, la longitud del vector <code>addmargins(tabla)[&quot;Sum&quot;,]</code>, la última entrada (correspondiente a la última columna) se puede eliminar especificando <code>-dim(addmargins(tabla))[2]</code> en las columnas al extraer la fila <code>Sum</code>.</p>
</div>
<div id="contraste-de-independencia" class="section level2">
<h2><span class="header-section-number">7.2</span> Contraste de independencia</h2>
<p>El contraste de independencia para tablas de contingencia bidimensionales consiste en decidir si las dos variables de la tabla tienen distribuciones independientes, es decir, si la distribución de probabilidades conjunta es igual al producto de las probabilidades marginales. En nuestro ejemplo, queremos decidir si podemos aceptar que las variables <code>tipo</code> y <code>max.frec</code> son independientes o si por el contrario hay evidencia de que la distribución de las bases de máxima frecuencia depende del tipo de cadena.</p>
<p>Vamos a extraer una muestra aleatoria simple de la población y observar los valores de las dos variables. En concreto, seleccionaremos una muestra <em>transversal</em> de 150 filas, al azar y con reposición, de entre las 10000 filas del <em>data frame</em> <code>poblacion</code>. El código es el siguiente (fijamos la semilla de aleatoriedad para que sea reproducible):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">42</span>)
n=<span class="dv">150</span>
indices.muestra=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>, <span class="dt">size=</span>n, <span class="dt">replace=</span><span class="ot">TRUE</span>)  
muestra.test.indep=<span class="st"> </span>poblacion[indices.muestra, ] <span class="co">#Las filas que forman la muestra</span></code></pre>
<p>Ahora calculamos la tabla de contingencia con sus marginales.</p>
<pre class="sourceCode r"><code class="sourceCode r">tabla.ind=<span class="kw">table</span>(muestra.test.indep<span class="op">$</span>tipo, muestra.test.indep<span class="op">$</span>max.frec)
tabla.ind</code></pre>
<pre><code>##    
##      a  c  g  t
##   A  8 17 16 12
##   B 23 22  3  7
##   C  4  9 17 12</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">tabla.ind.marg=<span class="kw">addmargins</span>(tabla.ind)
tabla.ind.marg</code></pre>
<pre><code>##      
##         a   c   g   t Sum
##   A     8  17  16  12  53
##   B    23  22   3   7  55
##   C     4   9  17  12  42
##   Sum  35  48  36  31 150</code></pre>
<p>Extraemos sus dos márgenes. Las frecuencias marginales de las filas:</p>
<pre class="sourceCode r"><code class="sourceCode r">frec.abs.tipo=tabla.ind.marg[<span class="op">-</span><span class="kw">dim</span>(tabla.ind.marg)[<span class="dv">1</span>],<span class="st">&quot;Sum&quot;</span>]
frec.abs.tipo</code></pre>
<pre><code>##  A  B  C 
## 53 55 42</code></pre>
<p>Las frecuencias marginales de las columnas:</p>
<pre class="sourceCode r"><code class="sourceCode r">frec.abs.max.frec=tabla.ind.marg[<span class="st">&quot;Sum&quot;</span>,<span class="op">-</span><span class="kw">dim</span>(tabla.ind.marg)[<span class="dv">2</span>]]
frec.abs.max.frec</code></pre>
<pre><code>##  a  c  g  t 
## 35 48 36 31</code></pre>
<p>El test de independencia usa las frecuencias absolutas esperadas bajo la hipótesis nula de independencia, que se obtienen, para cada celda <em>(i,j)</em>, multiplicando la frecuencia marginal de la fila <em>i</em> por la de la columna <em>j</em> y dividiendo por el tamaño de la muestra. En nuestro ejemplo estas frecuencias esperadas son
<span class="math display">\[
\begin{array}{l|cccc}
&amp; \mbox{a} &amp; \mbox{c} &amp; \mbox{g} &amp; \mbox{t} \\ \hline
\mbox{A} &amp; 53\cdot 35/150 &amp; 53\cdot 48/150 &amp; 53\cdot 36/150 &amp; 53\cdot 31/150 \\
\mbox{B} &amp; 55\cdot 35/150 &amp; 55\cdot 48/150 &amp; 55\cdot 36/150 &amp; 55\cdot 31/150 \\
\mbox{C} &amp; 42\cdot 35/150 &amp; 42\cdot 48/150 &amp; 42\cdot 36/150 &amp; 42\cdot 31/150 
\end{array}
\]</span>
y podemos obtenerlas fácilmente mediante un producto de matrices:
<span class="math display">\[
\frac{1}{150}\cdot\left(\begin{array}{c} 53 \\ 55 \\ 42\end{array}\right)\cdot
\big( 35 ,48 ,  36 , 31\big).
\]</span>
Por lo tanto, con R obtenemos esta tabla de frecuencias esperadas de la manera siguiente:</p>
<pre class="sourceCode r"><code class="sourceCode r">frec.esperadas=frec.abs.tipo<span class="op">%*%</span><span class="kw">t</span>(frec.abs.max.frec)<span class="op">/</span>n
frec.esperadas</code></pre>
<pre><code>##            a     c     g       t
## [1,] 12.3667 16.96 12.72 10.9533
## [2,] 12.8333 17.60 13.20 11.3667
## [3,]  9.8000 13.44 10.08  8.6800</code></pre>
<p>Aunque vayamos a realizar el test de independencia con una función de R, es necesario comprobar que todas estas frecuencias esperadas son mayores o iguales que 5, por lo que no podemos evitar este cálculo. En este caso vemos que se cumple esta condición.</p>
<p>Si queremos realizar el test <span class="math inline">\(\chi^2\)</span> de independencia a mano,
podemos calcular el estadístico de forma directa con</p>
<pre class="sourceCode r"><code class="sourceCode r">chi2.estadistico=<span class="kw">sum</span>((tabla.ind<span class="op">-</span>frec.esperadas)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>frec.esperadas)
chi2.estadistico</code></pre>
<pre><code>## [1] 32.1211</code></pre>
<p>y el p-valor del contraste, con</p>
<pre class="sourceCode r"><code class="sourceCode r">p.valor=<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(chi2.estadistico,<span class="dt">df=</span>(<span class="kw">dim</span>(tabla.ind)[<span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">dim</span>(tabla.ind)[<span class="dv">2</span>]<span class="op">-</span><span class="dv">1</span>))
p.valor</code></pre>
<pre><code>## [1] 1.54678e-05</code></pre>
<p>Para realizar el test <span class="math inline">\(\chi^2\)</span> de independencia con R, es suficiente aplicar la función <code>chisq.test</code> a la tabla de contingencia de frecuencias absolutas:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.ind)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tabla.ind
## X-squared = 32.12, df = 6, p-value = 1.55e-05</code></pre>
<p>Como el p-valor es muy pequeño, podemos rechazar la hipótesis de que las variables objeto de estudio sean independientes: hemos obtenido evidencia estadísticamente significativa de que la distribución de las bases de frecuencia máxima <em>sí que depende</em> del tipo de cadena.</p>
<p>Si algunas frecuencias absolutas esperadas fueran inferiores a 5, la
aproximación del p-valor por una distribución <span class="math inline">\(\chi^2\)</span> podría no ser adecuada.
En este caso, al ser las variables cualitativas, no podemos recurrir al
agrupamiento de valores consecutivos, puesto que no tienen orden. Si se da esta
situación, lo mejor es recurrir a simular el p-valor usando el parámetro
<code>simulate.p.value=TRUE</code>.</p>
<p>Por ejemplo, consideremos la situación siguiente, en la que tomamos una muestra de solo 100 cadenas y con otra semilla de aleatoriedad:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">300</span>)
n2=<span class="dv">100</span>
indices.muestra2=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>,<span class="dt">size=</span>n2,<span class="dt">replace=</span><span class="ot">TRUE</span>)
muestra.test.indep2=<span class="st"> </span>poblacion[indices.muestra2,]
tabla.ind2=<span class="kw">table</span>(muestra.test.indep2<span class="op">$</span>tipo,muestra.test.indep2<span class="op">$</span>max.frec)
tabla.ind2</code></pre>
<pre><code>##    
##      a  c  g  t
##   A 13 10 11 12
##   B  9 18  3  2
##   C  4  3 10  5</code></pre>
<p>Si aplicamos a esta tabla la función <code>chisq.test</code>, obtenemos:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.ind2)</code></pre>
<pre><code>## Warning in chisq.test(tabla.ind2): Chi-squared approximation may be
## incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tabla.ind2
## X-squared = 21.84, df = 6, p-value = 0.00129</code></pre>
<p>¡Vaya! Veamos la tabla de frecuencias esperadas:</p>
<pre class="sourceCode r"><code class="sourceCode r">frec.abs.tipo2=<span class="kw">rowSums</span>(tabla.ind2)
frec.abs.max.frec2=<span class="kw">colSums</span>(tabla.ind2)
frec.esperadas2=frec.abs.tipo2<span class="op">%*%</span><span class="kw">t</span>(frec.abs.max.frec2)<span class="op">/</span>n2
frec.esperadas2</code></pre>
<pre><code>##          a     c     g    t
## [1,] 11.96 14.26 11.04 8.74
## [2,]  8.32  9.92  7.68 6.08
## [3,]  5.72  6.82  5.28 4.18</code></pre>
<p>Hay una frecuencia esperada inferior a 5. Por lo tanto, lo recomendable es estimar el p-valor del test <span class="math inline">\(\chi^2\)</span> de independencia mediante simulaciones. Pero ahora tenemos que ir con cuidado en una cosa: hemos fijado la semilla de aleatoriedad para obtener una muestra de cadenas con frecuencias esperadas inferiores a 5. Lo recomendable es reiniciar esta semilla a un valor aleatorio con <code>set.seed(NULL)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="ot">NULL</span>)
<span class="kw">chisq.test</span>(tabla.ind2,<span class="dt">simulate.p.value=</span><span class="ot">TRUE</span>,<span class="dt">B=</span><span class="dv">5000</span>)<span class="op">$</span>p.value</code></pre>
<pre><code>## [1] 0.00139972</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.ind2,<span class="dt">simulate.p.value=</span><span class="ot">TRUE</span>,<span class="dt">B=</span><span class="dv">5000</span>)<span class="op">$</span>p.value</code></pre>
<pre><code>## [1] 0.00139972</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.ind2,<span class="dt">simulate.p.value=</span><span class="ot">TRUE</span>,<span class="dt">B=</span><span class="dv">5000</span>)<span class="op">$</span>p.value</code></pre>
<pre><code>## [1] 0.00159968</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.ind2,<span class="dt">simulate.p.value=</span><span class="ot">TRUE</span>,<span class="dt">B=</span><span class="dv">5000</span>)<span class="op">$</span>p.value</code></pre>
<pre><code>## [1] 0.00239952</code></pre>
<p>El p-valor es sistemáticamente pequeño, lo que nos permite rechazar la hipótesis de que las variables son independientes.</p>
</div>
<div id="sec:hom" class="section level2">
<h2><span class="header-section-number">7.3</span> Contraste de homogeneidad</h2>
<p>Como ya hemos dicho, la diferencia entre el contraste de homogeneidad y el de independencia está en el diseño del experimento: en cada contraste se selecciona la muestra de una manera diferente.</p>
<p>En nuestro caso, para contrastar si la distribución de probabilidades de la base de mayor frecuencia es la misma para cada tipo de cadena o no, lo que vamos a hacer es tomar una muestra aleatoria de 50 cadenas de cada tipo, juntarlas en una sola muestra <em>estratificada</em>, y aplicar el test <span class="math inline">\(\chi^2\)</span> a esta muestra. El código siguiente realiza el muestreo en cada subpoblación de <code>tipo</code> y guarda la muestra total en el <em>data frame</em> <code>muestra.test.homo</code>. Fijamos de nuevo la semilla de aleatoriedad (otra), para que el test sea reproducible.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)</code></pre>
<p>Generamos los vectores de índices de las muestras:</p>
<pre class="sourceCode r"><code class="sourceCode r">n3=<span class="dv">50</span>
indices.muestraA=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(poblacionA)[<span class="dv">1</span>],<span class="dt">size=</span>n3,<span class="dt">replace=</span><span class="ot">TRUE</span>)
indices.muestraB=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(poblacionB)[<span class="dv">1</span>],<span class="dt">size=</span>n3,<span class="dt">replace=</span><span class="ot">TRUE</span>)
indices.muestraC=<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(poblacionC)[<span class="dv">1</span>],<span class="dt">size=</span>n3,<span class="dt">replace=</span><span class="ot">TRUE</span>)</code></pre>
<p>Finalmente, tomamos las filas de cada muestra y las combinamos en un <em>data frame</em>:</p>
<pre class="sourceCode r"><code class="sourceCode r">muestraA<span class="fl">.50</span>=poblacionA[indices.muestraA,]
muestraB<span class="fl">.50</span>=poblacionB[indices.muestraB,]
muestraC<span class="fl">.50</span>=poblacionC[indices.muestraC,]
muestra.test.homo=<span class="kw">rbind</span>(muestraA<span class="fl">.50</span>,muestraB<span class="fl">.50</span>,muestraC<span class="fl">.50</span>)
<span class="kw">str</span>(muestra.test.homo)</code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  2 variables:
##  $ tipo    : Factor w/ 3 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max.frec: Factor w/ 4 levels &quot;a&quot;,&quot;c&quot;,&quot;g&quot;,&quot;t&quot;: 1 3 1 4 4 3 3 1 4 2 ...</code></pre>
<p>Calculamos la tabla de contingencia de la muestra:</p>
<pre class="sourceCode r"><code class="sourceCode r">tabla.homo=<span class="kw">table</span>(muestra.test.homo<span class="op">$</span>tipo,muestra.test.homo<span class="op">$</span>max.frec)
tabla.homo</code></pre>
<pre><code>##    
##      a  c  g  t
##   A 13 12 16  9
##   B 26 18  3  3
##   C  3 10 28  9</code></pre>
<p>Añadimos los márgenes:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(tabla.homo)</code></pre>
<pre><code>##      
##         a   c   g   t Sum
##   A    13  12  16   9  50
##   B    26  18   3   3  50
##   C     3  10  28   9  50
##   Sum  42  40  47  21 150</code></pre>
<p>Confirmamos que hemos tomado 50 cadenas de cada grupo. Ahora calculamos las frecuencias esperadas bajo la hipótesis nula, para comprobar si son todas mayores o iguales que 5:</p>
<pre class="sourceCode r"><code class="sourceCode r">frec.abs.tipo=<span class="kw">rowSums</span>(tabla.homo)
frec.abs.tipo</code></pre>
<pre><code>##  A  B  C 
## 50 50 50</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">frec.abs.max.frec=<span class="kw">colSums</span>(tabla.homo)
frec.abs.max.frec</code></pre>
<pre><code>##  a  c  g  t 
## 42 40 47 21</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">frec.esperadas=frec.abs.tipo<span class="op">%*%</span><span class="kw">t</span>(frec.abs.max.frec)<span class="op">/</span><span class="kw">sum</span>(frec.abs.tipo)
frec.esperadas  </code></pre>
<pre><code>##       a       c       g t
## [1,] 14 13.3333 15.6667 7
## [2,] 14 13.3333 15.6667 7
## [3,] 14 13.3333 15.6667 7</code></pre>
<p>Todas las frecuencias son mayores o iguales que 5, así que aplicamos la función <code>chisq.test</code> sin simular el p-valor:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(tabla.homo)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tabla.homo
## X-squared = 44.99, df = 6, p-value = 4.71e-08</code></pre>
<p>El p-valor es muy pequeño, por lo que podemos rechazar que las distribuciones de los valores de las bases de máxima frecuencia sean la misma para cada valor de la variable <code>tipo</code>.</p>
<p>En definitiva, el tipo de cadena afecta a la distribución de la base de mayor frecuencia. Es la misma conclusión a la que habíamos llegado con el test de independencia, solo que ahora hemos realizado un tipo de experimento diferente.</p>
</div>
<div id="potencia-de-un-contraste-chi2" class="section level2">
<h2><span class="header-section-number">7.4</span> Potencia de un contraste <span class="math inline">\(\chi^2\)</span></h2>
<p>La potencia de un contraste <span class="math inline">\(\chi^2\)</span>, tanto de bondad de ajuste como de independencia o de homogeneidad, se puede calcular de manera similar a cómo lo hacíamos en otros tipos de contrastes de uno o dos parámetros. La instrucción para llevarlo a cabo es <code>pwr.chisq.test</code> del paquete <strong>pwr</strong>. Su sintaxis básica es</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pwr.chisq.test</span>(<span class="dt">N=</span>..., <span class="dt">df=</span>..., <span class="dt">sig.level=</span>..., <span class="dt">w=</span>..., <span class="dt">power=</span>...)</code></pre>
<p>donde:</p>
<ul>
<li><code>N</code> es el tamaño de la muestra.</li>
<li><code>df</code> es el número de grados de libertad del estadístico (recordad que en un test de bondad de ajuste es el número de clases menos 1 y menos el número de parámetros estimados, y en un test de independencia o de homogeneidad es el número de niveles de una variable menos 1 por el número de niveles de la otra variable menos 1).</li>
<li><code>sig.level</code> es el nivel de significación <span class="math inline">\(\alpha\)</span>.</li>
<li><code>w</code> es la magnitud del efecto, que en este tipo de tests se define como <span class="math inline">\(\sqrt{X^2/N}\)</span>, siendo <span class="math inline">\(X^2\)</span> el valor del estadístico de contraste y <span class="math inline">\(N\)</span> el tamaño de la muestra completa.</li>
<li><code>power</code> es la potencia <span class="math inline">\(1-\beta\)</span>.</li>
</ul>
<p>Si se especifican todos estos parámetros menos uno, la función da el valor del parámetro que falta. Normalmente, querremos saber la potencia de un contraste <em>a posteriori</em> o el tamaño de la muestra necesario para tener la potencia deseada para una magnitud del efecto esperada concreta.</p>
<p>Veamos algunos ejemplos de uso de esta función.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-365" class="example"><strong>Ejemplo 7.1  </strong></span>Vamos a calcular la potencia del contraste del Ejemplo <a href="chap-bondad.html#exm:dado">6.3</a>.
En ese ejemplo, el tamaño de la muestra fue <span class="math inline">\(N=40\)</span>, el número de grados de libertad fue 5
y obtuvimos que <span class="math inline">\(X^2=7.7\)</span>, por lo que la magnitud del efecto fue <span class="math inline">\(w=\sqrt{7.7/40}\)</span>. Tomaremos el nivel de significación usual, <span class="math inline">\(\alpha=0.05\)</span>.</p>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pwr)
<span class="kw">pwr.chisq.test</span>(<span class="dt">N=</span><span class="dv">40</span>, <span class="dt">df=</span><span class="dv">5</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">w=</span><span class="kw">sqrt</span>(<span class="fl">7.7</span><span class="op">/</span><span class="dv">40</span>))</code></pre>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.438748
##               N = 40
##              df = 5
##       sig.level = 0.05
##           power = 0.545751
## 
## NOTE: N is the number of observations</code></pre>
<p>La potencia del contraste ha sido de, aproximadamente, un 55%.</p>
<p>Para obtener solo la potencia, podemos usar el sufijo <code>$power</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pwr.chisq.test</span>(<span class="dt">N=</span><span class="dv">40</span>, <span class="dt">df=</span><span class="dv">5</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">w=</span><span class="kw">sqrt</span>(<span class="fl">7.7</span><span class="op">/</span><span class="dv">40</span>))<span class="op">$</span>power</code></pre>
<pre><code>## [1] 0.545751</code></pre>

<div class="example">
<p><span id="exm:unnamed-chunk-368" class="example"><strong>Ejemplo 7.2  </strong></span>Vamos a calcular la potencia del contraste de normalidad de las longitudes de los sépalos de flores iris del Ejemplo <a href="chap-bondad.html#exm:testnormiris1">6.8</a>. En ese ejemplo el tamaño de muestra fue <span class="math inline">\(N=150\)</span>; como usamos 7 clases, pero estimamos 2 parámetros, el número de grados de libertad fue 4; obtuvimos que <span class="math inline">\(X^2=11.0637\)</span>, por lo que <span class="math inline">\(w=\sqrt{11.0637/150}\)</span>; y ahora, por variar, tomaremos <span class="math inline">\(\alpha=0.1\)</span>.</p>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pwr.chisq.test</span>(<span class="dt">N=</span><span class="dv">150</span>, <span class="dt">df=</span><span class="dv">4</span>, <span class="dt">sig.level=</span><span class="fl">0.1</span>, <span class="dt">w=</span><span class="kw">sqrt</span>(<span class="fl">11.0637</span><span class="op">/</span><span class="dv">15</span>))<span class="op">$</span>power</code></pre>
<pre><code>## [1] 1</code></pre>
<p>La potencia da 1: la probabilidad de que aceptáramos que la muestra seguía una distribución normal si no fuera verdad es prácticamente 0.</p>

<div class="example">
<p><span id="exm:unnamed-chunk-370" class="example"><strong>Ejemplo 7.3  </strong></span>En el contraste de homogeneidad de la Sección <a href="chap-indep.html#sec:hom">7.3</a> hemos tomado tres muestras de 50 individuos cada una, en total 150 individuos. El estadístico de contraste ha valido <span class="math inline">\(X^2=28.59\)</span>, por lo que la magnitud del efecto en ese test ha sido de <span class="math inline">\(w=\sqrt{28.59/150}=0.4366\)</span>, entre mediana y grande según la función <code>cohen.ES</code>, que nos da las magnitudes del efecto que por convención se entienden como pequeñas, medianas o grandes para los diferentes tests considerados en el paquete <strong>pwr</strong>:</p>
</div>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohen.ES</span>(<span class="dt">test=</span><span class="st">&quot;chisq&quot;</span>, <span class="dt">size=</span><span class="st">&quot;medium&quot;</span>)<span class="op">$</span>effect.size</code></pre>
<pre><code>## [1] 0.3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cohen.ES</span>(<span class="dt">test=</span><span class="st">&quot;chisq&quot;</span>, <span class="dt">size=</span><span class="st">&quot;large&quot;</span>)<span class="op">$</span>effect.size</code></pre>
<pre><code>## [1] 0.5</code></pre>
<p>¿De qué tamaño deberíamos haber tomado las muestras para garantizar una potencia del 90%, suponiendo que esperásemos una magnitud del efecto mediana y tomásemos un nivel de significación <span class="math inline">\(\alpha=0.05\)</span>?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pwr.chisq.test</span>(<span class="dt">df=</span><span class="dv">6</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">w=</span><span class="fl">0.3</span>, <span class="dt">power=</span><span class="fl">0.9</span>)</code></pre>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.3
##               N = 193.543
##              df = 6
##       sig.level = 0.05
##           power = 0.9
## 
## NOTE: N is the number of observations</code></pre>
<p>Hubiéramos necesitado como mínimo un total de unos 194 individuos: si queríamos tomar las tres muestras del mismo tamaño, esto significa tres muestras de como mínimo 65 individuos cada una.</p>
<p>Para obtener solo el tamaño de la muestra, se puede añadir el sufijo <code>$N</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pwr.chisq.test</span>(<span class="dt">df=</span><span class="dv">6</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">w=</span><span class="fl">0.3</span>, <span class="dt">power=</span><span class="fl">0.9</span>)<span class="op">$</span>N</code></pre>
<pre><code>## [1] 193.543</code></pre>
</div>
<div id="guia-rapida-5" class="section level2">
<h2><span class="header-section-number">7.5</span> Guía rápida</h2>
<ul>
<li><p><code>table</code> calcula tablas de contingencia de frecuencias absolutas.</p></li>
<li><p><code>prop.table</code> calcula tablas de contingencia de frecuencias relativas.</p></li>
<li><p><code>addmargins</code> sirve para añadir a una <code>table</code> una fila o una columna obtenidas aplicando una función a todas las columnas o a todas las filas de la tabla, respectivamente. Sus parámetros principales son:</p>
<ul>
<li><p><code>margin</code>: igualado a <code>1</code>, se aplica la función por columnas, añadiendo una nueva fila; igualado a <code>2</code>, se aplica la función por filas, añadiendo una nueva columna;
igualado a <code>c(1,2)</code>, que es su valor por defecto, hace ambas cosas.</p></li>
<li><p><code>FUN</code>: la función que se aplica a las filas o columnas; su valor por defecto es <code>sum</code>.</p></li>
</ul></li>
<li><p><code>colSums</code> calcula un vector con las sumas de las columnas de una matriz o una tabla.</p></li>
<li><p><code>rowSums</code> calcula un vector con las sumas de las filas de una matriz o una tabla.</p></li>
<li><p><code>chisq.test</code> sirve para realizar tests <span class="math inline">\(\chi^2\)</span> de independencia y homogeneidad. El resultado es una <code>list</code> formada, entre otros, por los objetos siguientes: <code>statistic</code> (el valor del estadístico <span class="math inline">\(X^2\)</span>), <code>parameter</code> (los grados de libertad) y <code>p.value</code> (el p-valor). Sus parámetros principales en el contexto de esta lección son:</p>
<ul>
<li><code>simulate.p.value</code>: igualado a <code>TRUE</code>, calcula el p-valor mediante simulaciones.</li>
<li><code>B</code>: en este último caso, permite especificar el número de simulaciones.</li>
</ul></li>
<li><p><code>pwr.chisq.test</code>, del paquete <strong>pwr</strong>, sirve para calcular uno de los parámetros siguientes a partir de los otros cuatro:</p>
<ul>
<li><code>N</code>: el tamaño de la muestra.</li>
<li><code>df</code>: el número de grados de libertad del contraste.</li>
<li><code>sig.level</code>: el nivel de significación <span class="math inline">\(\alpha\)</span>.</li>
<li><code>power</code>: la potencia <span class="math inline">\(1-\beta\)</span>.</li>
<li><code>w</code>: la magnitud del efecto.</li>
</ul></li>
</ul>
</div>
<div id="ejercicios-7" class="section level2">
<h2><span class="header-section-number">7.6</span> Ejercicios</h2>
<div id="modelo-de-test-2" class="section level3 unnumbered">
<h3>Modelo de test</h3>
<p><em>(1)</em> Hemos observado dos variables cualitativas en una muestra de una población. Cada variable tiene 3 niveles. La tabla de contingencia resultante ha sido la siguiente:
<span class="math display">\[
\begin{array}{c|ccc} &amp;X&amp;Y&amp;Z\cr\hline A &amp; 2 &amp; 17 &amp; 11\cr B &amp; 8 &amp; 10 &amp; 25\cr C &amp; 3 &amp; 14 &amp; 5 \end{array}
\]</span>
¿Es verdad que, si estas variables aleatorias fueran independientes, las frecuencias esperadas de cada combinación de niveles, uno de cada variable, serían todas <span class="math inline">\(\geqslant 5\)</span>? Tenéis que contestar SI, en mayúsculas y sin acento, o NO.</p>
<p><em>(2)</em> Hemos observado dos variables cualitativas en una muestra de una población. Una variable tiene 4 niveles y la otra 3. La tabla de contingencia resultante ha sido la siguiente:
<span class="math display">\[
\begin{array}{c|cccc} &amp;A&amp;B&amp;C &amp; D\cr\hline X &amp; 50 &amp; 19&amp;17 &amp; 21\cr Y &amp;69 &amp; 47 &amp; 56 &amp; 37 \cr Z &amp;33 &amp; 23 &amp; 18 &amp; 21 \end{array}
\]</span>
Emplead la función <code>chisq.test</code> para contrastar si estas dos variables son independientes o no. Tenéis que dar el p-valor del test (redondeado a 3 cifras decimales, sin ceros innecesarios a la derecha) y decir (contestando SI o NO) si, con un nivel de significación <span class="math inline">\(\alpha=0.1\)</span>, podríamos rechazar la hipótesis nula de que estas dos variables son independientes. Dad las dos respuestas en este orden y separadas por un único espacio en blanco.</p>
<p><em>(3)</em> Hemos realizado un test <span class="math inline">\(\chi^2\)</span> de independencia sobre una muestra de 200 individuos,
con un nivel de significación de 0.1. Las variables objeto de estudio tenían 5 y 6 niveles, respectivamente.
El estadístico de contraste ha valido <span class="math inline">\(16.56\)</span>. ¿Cuál es el p-valor del contraste? ¿Cuál es la potencia del
contraste realizado? Tenéis que dar ambos valores en este orden, redondeados a 3 cifras decimales sin ceros innecesarios
a la derecha, y separados por un único espacio en blanco.</p>
</div>
<div id="ejercicios-8" class="section level3 unnumbered">
<h3>Ejercicios</h3>
<p><strong>(1)</strong> En un estudio para determinar si la tensión arterial depende del grupo sanguíneo, se tomó una muestra aleatoria de 1500 personas, se determinó su grupo sanguíneo y se les midió la tensión, clasificándola en baja, normal o alta. Los resultados fueron los de la tabla siguiente:</p>
<p><span class="math display">\[
\begin{array}{l}
\hphantom{TensionAAa}\text{Grupo sanguíneo}\\
\begin{array}{l|cccc}
\text{Tensión} &amp; \text{A} &amp; \text{B} &amp; \text{AB} &amp; 0\\ \hline
\text{Baja} &amp; 28 &amp;  9   &amp;7 &amp;    31\\
\text{Normal} &amp; 543 &amp;   211 &amp;   90 &amp;    476\\
\text{Alta} &amp; 44    &amp;22     &amp;8 &amp;    31\\
\hline
\end{array}
\end{array}
\]</span></p>
<p>Como hemos dicho, a partir de estos datos queremos decidir si hay asociación entre la tensión arterial y el grupo sanguíneo.</p>
<p><em>(a)</em> Según el diseño del experimento, ¿qué tipo de contraste estamos realizando: de independencia o de homogeneidad?</p>
<p><em>(b)</em> Comprobad si se dan las condiciones para poder efectuar un test <span class="math inline">\(\chi^2\)</span>. En caso afirmativo, llevadlo a cabo. En caso negativo, usad el método de Montecarlo.</p>
</div>
<div id="respuestas-al-test-6" class="section level3 unnumbered">
<h3>Respuestas al test</h3>
<p><em>(1)</em> NO</p>
<p>Nosotros lo hemos mirado con</p>
<pre class="sourceCode r"><code class="sourceCode r">A=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">17</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">3</span>,<span class="dv">14</span>,<span class="dv">5</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)
RS=<span class="kw">rowSums</span>(A)
CS=<span class="kw">colSums</span>(A)
frec.esperadas=RS<span class="op">%*%</span><span class="kw">t</span>(CS)<span class="op">/</span><span class="kw">sum</span>(A)
frec.esperadas</code></pre>
<pre><code>##         [,1]     [,2]     [,3]
## [1,] 4.10526 12.94737 12.94737
## [2,] 5.88421 18.55789 18.55789
## [3,] 3.01053  9.49474  9.49474</code></pre>
<p><em>(2)</em> 0.128 NO</p>
<p>Nosotros lo hemos resuelto con</p>
<pre class="sourceCode r"><code class="sourceCode r">X=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">19</span>,<span class="dv">17</span>,<span class="dv">21</span>,<span class="dv">69</span>,<span class="dv">47</span>,<span class="dv">56</span>,<span class="dv">37</span>,<span class="dv">33</span>,<span class="dv">23</span>,<span class="dv">18</span>,<span class="dv">21</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">byrow=</span>T)
<span class="kw">round</span>(<span class="kw">chisq.test</span>(X)<span class="op">$</span>p.value,<span class="dv">3</span>)</code></pre>
<pre><code>## [1] 0.128</code></pre>
<p><em>(3)</em> 0.681 0.777</p>
<p>Nosotros lo hemos resuelto con</p>
<pre class="sourceCode r"><code class="sourceCode r">p.valor=<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="fl">16.56</span>,(<span class="dv">5-1</span>)<span class="op">*</span>(<span class="dv">6-1</span>))
potencia=<span class="kw">pwr.chisq.test</span>(<span class="dt">N=</span><span class="dv">200</span>, <span class="dt">df=</span>(<span class="dv">5-1</span>)<span class="op">*</span>(<span class="dv">6-1</span>), <span class="dt">sig.level=</span><span class="fl">0.1</span>, <span class="dt">w=</span><span class="kw">sqrt</span>(<span class="fl">16.56</span><span class="op">/</span><span class="dv">200</span>))<span class="op">$</span>power
<span class="kw">round</span>(<span class="kw">c</span>(p.valor,potencia),<span class="dv">3</span>)</code></pre>
<pre><code>## [1] 0.681 0.777</code></pre>
</div>
<div id="soluciones-sucintas-de-los-problemas-5" class="section level3 unnumbered">
<h3>Soluciones sucintas de los problemas</h3>
<p><em>(a)</em> De independencia, porque la muestra es transversal</p>
<p><em>(b)</em></p>
<pre class="sourceCode r"><code class="sourceCode r">Datos=<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">28</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">31</span>),<span class="kw">c</span>(<span class="dv">543</span>,<span class="dv">211</span>,<span class="dv">90</span>,<span class="dv">476</span>),<span class="kw">c</span>(<span class="dv">44</span>,<span class="dv">22</span>,<span class="dv">8</span>,<span class="dv">31</span>))
Datos</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   28    9    7   31
## [2,]  543  211   90  476
## [3,]   44   22    8   31</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">n=<span class="kw">sum</span>(Datos)
n</code></pre>
<pre><code>## [1] 1500</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">freq.esp.tipo=<span class="kw">colSums</span>(Datos)
freq.esp.tensión=<span class="kw">rowSums</span>(Datos)
frec.esperadas=freq.esp.tensión%<span class="op">*</span>%<span class="kw">t</span>(freq.esp.tipo)<span class="op">/</span>n
frec.esperadas</code></pre>
<pre><code>##        [,1]   [,2]  [,3]   [,4]
## [1,]  30.75  12.10  5.25  26.90
## [2,] 541.20 212.96 92.40 473.44
## [3,]  43.05  16.94  7.35  37.66</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(Datos)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  Datos
## X-squared = 5.116, df = 6, p-value = 0.529</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>El valor por defecto de <code>margin</code> es el vector de todas las dimensiones de la tabla. Hay que recordar que, aunque ahora sólo tratamos con tablas bidimensionales, con <code>table</code> se pueden especificar tablas de contingencia de un número arbitrario de dimensiones.<a href="chap-indep.html#fnref7" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-bondad.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-estmult.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cescrossello/AprendeR-II/edit/master/07-Independencia.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["AprendeR-Parte-II.pdf", "AprendeR-Parte-II.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
